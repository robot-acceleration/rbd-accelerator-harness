# tb_vjDot
#
# Testbench for vjDot.jl

#-------------------------------------------------------------------------------
# Import Libraries
#-------------------------------------------------------------------------------
using LinearAlgebra
using FixedPointNumbers
using Test
include("../../../type_generic/dynamics/helpers_iiwa.jl")
include("vjDot.jl") # vjDot

#-------------------------------------------------------------------------------
# Data Type
#-------------------------------------------------------------------------------
CUSTOM_TYPE = Float64 ###Fixed{Int32,24} # data type

#-------------------------------------------------------------------------------
# Set Constants
#-------------------------------------------------------------------------------
X,Y,Z,AX,AY,AZ,LX,LY,LZ,g = initConstants(CUSTOM_TYPE)

#-------------------------------------------------------------------------------
# Define Test Function
#-------------------------------------------------------------------------------
function vjDotTest(CUSTOM_TYPE,X,Y,Z,AX,AY,AZ,LX,LY,LZ,test)
   #----------------------------------------------------------------------------
   # Inputs and Expected Outputs
   #----------------------------------------------------------------------------
   if (test == 1)     # Test 1
      vjval = 0.555751087
      colvec = [-0.00190267; -1.98746e-5; -0.450045; 0.189009; 0.00197431; -0.000799164]
      vjvec = [-1.10453e-5; 0.00105741; 0.0; 0.00109723; -0.105042; 0.0]
   elseif (test == 2) # Test 2
      vjval = 0.437107975
      colvec = [0.336102; -0.299299; -1.98746e-5; -0.180919; -0.203166; 0.00197431]
      vjvec = [-0.130826; -0.146913; 0.0; -0.0888054; 0.0790812; 0.0]
   elseif (test == 3) # Test 3
      vjval = 0.773223048
      colvec = [-0.687073; 0.606431; -0.399976; 0.598861; 0.525089; -0.232591]
      vjvec = [0.468907; 0.531261; 0.0; 0.406011; -0.463053; 0.0]
   end

   #----------------------------------------------------------------------------
   # Unit Under Test
   #----------------------------------------------------------------------------
   vjvec_out = vjDot(CUSTOM_TYPE,X,Y,Z,AX,AY,AZ,LX,LY,LZ,
                     vjval,colvec)

   #----------------------------------------------------------------------------
   # Print Outputs
   #----------------------------------------------------------------------------
   println("Test = ",test)
   println("Expected: ",vjvec)
   println("Got:      ",vjvec_out)

   #----------------------------------------------------------------------------
   # Test Outputs
   #----------------------------------------------------------------------------
   @test vjvec_out â‰ˆ vjvec atol=1e-5
   println("Test passed!")
end

#-------------------------------------------------------------------------------
# Set Test Parameters and Run Test
#-------------------------------------------------------------------------------
test = 1;
vjDotTest(CUSTOM_TYPE,X,Y,Z,AX,AY,AZ,LX,LY,LZ,test)
test = 2;
vjDotTest(CUSTOM_TYPE,X,Y,Z,AX,AY,AZ,LX,LY,LZ,test)
test = 3;
vjDotTest(CUSTOM_TYPE,X,Y,Z,AX,AY,AZ,LX,LY,LZ,test)
